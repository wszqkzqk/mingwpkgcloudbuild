# Maintainer: Morten Linderud <foxboron@archlinux.org>

_realname=jp2a
pkgbase="mingw-w64-${_realname}"
pkgname="${MINGW_PACKAGE_PREFIX}-${_realname}"
pkgver=1.1.1
pkgrel=1
pkgdesc='A small utility for converting JPG images to ASCII'
arch=('any')
mingw_arch=('mingw32' 'mingw64' 'ucrt64' 'clang64' 'clang32' 'clangarm64')
url='https://github.com/Talinx/jp2a/'
license=('GPL2')
depends=(   "${MINGW_PACKAGE_PREFIX}-curl"
            "${MINGW_PACKAGE_PREFIX}-libjpeg"
            "${MINGW_PACKAGE_PREFIX}-libpng")
makedepends=(   "${MINGW_PACKAGE_PREFIX}-doxygen"
                'autoconf-archive'
                'git')
_commit=9ed01d6aa57c5b63657abe5c76cd28935206084c	#refs/tags/v1.1.0
source=("git+https://github.com/Talinx/jp2a.git#commit=${_commit}?signed")
validpgpkeys=("5FCAE86E581E73AD91CB3235E7DBBCF6B02920CC") # Christoph Raitzig
sha256sums=('SKIP')

prepare(){
  cd "${pkgname}"
  autoreconf -vi
}

build(){
  cd "${pkgname}"
  bashcompdir=/usr/share/bash-completion/completions ./configure --prefix='/usr'
  make
}

check() {
  cd "${pkgname}"
  make check
}

package(){
  cd "${pkgname}"
  make DESTDIR="${pkgdir}" install
}